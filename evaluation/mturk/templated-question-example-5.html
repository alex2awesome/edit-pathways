<HTMLQuestion xmlns="http://mechanicalturk.amazonaws.com/AWSMechanicalTurkDataSchemas/2011-11-11/HTMLQuestion.xsd">
<HTMLContent><![CDATA[

<!-- YOUR HTML BEGINS -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
<script type='text/javascript' src='https://s3.amazonaws.com/mturk-public/externalHIT_v1.js'></script>
</head>
<link type="text/css" href="https://getbootstrap.com/1.0.0/assets/css/bootstrap-1.0.0.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://creativecouple.github.io/jquery-timing/jquery-timing.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
<!-- ContextMenu -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.7.1/jquery.contextMenu.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.7.1/jquery.contextMenu.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.7.1/jquery.ui.position.js"></script>

<!-- alertify -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/AlertifyJS/1.13.1/alertify.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/AlertifyJS/1.13.1/css/alertify.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/AlertifyJS/1.13.1/css/themes/bootstrap.min.css">
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/AlertifyJS/1.13.1/css/themes/default.css"> -->

<script src="https://cdn.jsdelivr.net/gh/qiao/difflib.js/dist/difflib-browser.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/gh/musclesoft/jquery-connections/jquery.connections.js"></script>

<style>

.example{
    background-color: #d7d7d7;
    margin-left: 20px;
    margin-right: 50px;
    padding: 10px;
    padding-bottom: 1px;
    margin-bottom: 10px;
}

.highlighted {
	background-color: yellow;
}

.text-mouseover{
	border-style: solid;
}

.connection {
	border: 8px double;
    /*border-width: 2.5px;*/
	z-index: 0;
	/*display: table;*/
	border-radius: 100%;
	/*pointer-events:none;*/
	color: rgb(200, 200, 200);
	color: rgba(0, 0, 0, 0.7);
}


/* Handle the question text-boxes */
.textblock {
    border-radius: 4px;
    color: black;
    background: rgba(237, 245, 241, 0.87);
    display: inline-block;
    border: 2px solid Black;
    padding: 6px 10px 6px 10px;
    z-index: 1;
    position: relative;
}

.textblock-row{
    /*background-color: rgba(128, 128, 128, 0.56);*/
    margin: 10px 10px 10px 10px;
    border-radius: 4px;
}

.textblock-ref {
    border-radius: 2px;
    color: #363535;
    background: #B6ACACAC;
    display: inline-block;
    border: 1px solid Black;
    padding: 8px 10px 8px 10px;
    z-index: 1;
    position: relative;
}

.textblock-row-ref{
    /*background-color: rgba(128, 128, 128, 0.56);*/
    margin: 8px 10px 8px 10px;
    border-radius: 4px;
}

.textblock_pool {
	height: 200px;
}

.center-button{
   display: -webkit-inline-flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
  -webkit-flex-direction: column;
  -webkit-box-pack: center;
  -webkit-flex-pack: center;
  -webkit-justify-content: center;
  -webkit-flex-align: center;
  -webkit-align-items: center;
  vertical-align: top;
}


ul{
    padding: 0px;
}

li{
    padding: 0px;
    marging: 0px;
}

.textblock_span {
	padding-right: 10px;
}

.shaded {
	border-color: #55f;
}

#submitButton{
    z-index: 5;
}

#feedback{
    width: 100%;
}

hr.hr-medium{
    border: 3px solid black;
}

body{
    margin: 10px !important;
}


.color-none{
    background-color: transparent;
    color: transparent;
}

.hidden {
    /*transition: opacity 1s ease-out;*/
    /*opacity: 0;*/
    /*height: 0;*/
    /*overflow: hidden;*/
    /*color: white;*/
    visibility: hidden;
}

.hidden-none{
    display: None;
}


.textblock-deleted{
    background-color: rgba(222, 131, 132, 0.72);
    border-color: gray;
}

.textblock-text-deleted{
    color: gray;
    text-decoration: line-through;
}

/*.hidden{*/
/*    display: none;*/
/*}*/


</style>
<!-- jquery connections -->
<body>


<form name='mturk_form' method='post' id='mturk_form' action='/mturk/externalSubmit'>
<input type='hidden' value='' name='assignmentId' id='assignmentId'/>

<div class="table table-hover container">
    <div class="row instructions">
        <div class="col-12">
            <div id="accordion">
              <div class="card">
                <div class="card-header" id="hello_header">
                  <h5 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#hello">
                      Hello, about us, and thank you for your help!
                    </button>
                  </h5>
                </div>
                <div id="hello" class="collapse show" aria-labelledby="hello_header" data-parent="#accordion">
                  <div class="card-body">
                    Hello! We are small research lab in University of Southern California trying to build AI tools to help
                    citizens better understand the work journalists do.
                    <br><br>
                    We are calibrating our payment scheme <b>to meet a $15 per hour wage and will reward workers who take time
                    to give correct answers</b>.
                    <br><br>
                    If you perform well, we will invite you to participate in future, well-paying trials. If you speed through and give nonsense
                    answers, <b>we will block you and report to Mechanical Turk</b>. We understand the pressures of Mechanical Turk, but we are a
                    small lab and cannot afford to throw out too much data.
                  </div>
                </div>
              </div>
              <div class="card">
                <div class="card-header" id="headingOne">
                  <h5 class="mb-0">
                    <button class="btn btn-link collapsed" data-toggle="collapse" type="button" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                      Instructions
                    </button>
                  </h5>
                </div>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
                    <div class="card-body">
                        <h2>Goals and Overview</h2>
                        <p>The goal of this exercise is to help us identify sentences in an article-rewrite that contain substantially new information.</p>
                        <p>To do this, you will identiy which sentences <b><i>match</i></b> between two versions of an article.</p>
                        <p>
                        <h4>Two sentences <b><i>match</i></b> if:</h4>
                            <ul>
                                <li><b><i>Option 1:</i></b> They are nearly the same, word-for-word.</li>
                                <li><b><i>Option 2:</i></b> They convey the same information but are <u>stylistically different.</u></li>
                                <li><b><i>Option 3:</i></b> They have slightly different information but have <u>substantial overlap in meaning</u> and <u>narrative function.</u></li>
                            </ul>
                        </p>

                        Examples of <b><i>Option 3</i></b> include (please see the "Examples" section for real examples):
                        <ul>
                            <li>Updating events.
                                <ul>
                                    <li>(Ex) <i>The man was presumed missing. &rarr; The man was found in his home.</i></li>
                                    <li>(Ex) <i>The death count was at 23. &rarr; 50 were found dead.</i></li>
                                    <li>(Ex) <i>The senators are still negotiating the details. &rarr; The senators have reached a deal.</i></li>
                                </ul>
                            </li>
                            <li>An improved analysis.
                                <ul>
                                    <li>(Ex) <i>The president is likely seeking improved relations. &rarr; The president is likely hoping that hard-liners will give way to moderates, improving relations.</i></li>
                                    <li>(Ex) <i>The storm, a Category IV, is expected to hit Texas. &rarr; The storm, downgraded to Category III, is projected to stay mainly in the Gulf.</i></li>
                                    <li>(Ex) <i>Analysts widely think the shock will be temporary. &rarr; The shock, caused by widespread shipping delays, might last into December, but will ultimately subside.</i></li>
                                </ul>
                            </li>
                            <li>A quote that is very similar or serves the same purpose.
                                <ul>
                                    <li>(Ex) <i>"We knew we had to get it done." said Senator Murphy. &rarr; "At the end of the day, no one could leave until we had a deal" said Senator Harris.</i></li>
                                    <li>(Ex) <i>"It was gripping." said the bystander. &rarr; "I couldn't stop watching." said a moviegoer.</i></li>
                                </ul>
                            </li>
                        </ul>

                        <p>
                        <h4>Two sentences <b><i>do not match</i></b> if:</h4>
                            <ul>
                                <li>They contain substantially different information.</li>
                                <li>They serve different narrative functions.</li>
                                <li>There is a much better match for one sentence somewhere else in the document.</li>
                            </ul>
                        </p>
                        <p>
                        <h4>Things to keep in mind:</h4>
                            <ul>
                                <li>Two sentences might match <u>even if they are in different parts of the document.</u></li>
                                <li>One sentence can match <u>with multiple other sentences</u>, because that sentence might be split up into multiple sentences, each with similar information as parts of the original.</li>
                                <li>Sentences <i>don't have to match</i>.
                                    <ul>
                                        <li>Substantially new information, perspectives or narrative tools might be added in a new version.</li>
                                        <li>Substantially old information, perspectives or narrative tools might be removed from an old version.</li>
                                    </ul>
                                </li>
                            </ul>
                        </p>

                        <h4>Steps to completing the task:</h4>
                        <ol>
                            <li>For each sentence in the left-hand column, determine if its <b><i>matches</i></b> with a sentence on the right.
                                <ul>
                                    <li>By mousing over the sentence block, you will see word-overlaps between the moused-over block and all blocks in the opposite column.
                                        <b>THIS IS MEANT TO BE HELPFUL BUT NOT COMPLETE.</b> Please do not rely on this alone.
                                        We expect that many sentences with high word-overlap still might convey different information.
                                        <i>We will be checking answers for completeness!!</i></li>
                                    <li>If you find two blocks that look very similar but are not exactly the same, ask yourself: is there substantially new information included?
                                        Or is the edit merely cosmetic?</li>
                                </ul>
                            </li>
                            <li>When you find blocks that you think should match - i.e. they contain the same, or substantially similar information - connect them by:
                                (a) right-clicking on the first block and (b) right clicking on it's matching block</li>
                            <li>If you right-click on a block accidentally, you may right-click on the same block to remove the line.</li>
                            <li>Please note, <i>there may be blocks that do not match!!</i> This is OK.</li>
                        </ol>
                    </div>
                </div>
              </div>
              <div class="card">
                <div class="card-header" id="headingOne">
                  <h5 class="mb-0">
                    <button class="btn btn-link collapsed" data-toggle="collapse" type="button" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                      Video
                    </button>
                  </h5>
                </div>
                <div id="collapseFour" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
                    <div class="card-body">

                                        <p>
                            <video width="320" height="240" controls>
                              <source src="https://storage.googleapis.com/public-mturk-resources/sped-up-2.mov" type="video/mp4">
                            Your browser does not support the video tag.
                            </video>
                        </p>
                    </div>
                </div>
              </div>
              <div class="card">
                <div class="card-header" id="headingOne">
                  <h5 class="mb-0">
                    <button class="btn btn-link collapsed" data-toggle="collapse" type="button" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                      Examples
                    </button>
                  </h5>
                </div>
                <div id="collapseThree" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
                    <div class="card-body">
                        In the examples below, we'll show sentence pairs that we consider matches. The sentence(s) from the old version will occur first, followed by the sentence(s) from the new version. Green text is text that has been added (i.e. it is specific the new version) and red text is text that has been remove (i.e. it is specific to the old version).

                        <h4>Sentences that contain the same information:</h4>
                        <p>The following sentences convey the same information, however, they are cosmetically different.</p>


                        <h5>Example 1</h5>
                        <p><i>This is a sentence pair where only a few style edits have been made.</i></p>

                        <div class="example">
                            <p>ZABUL , Afghanistan — A complex attack on a military base in southern Afghanistan Monday <span style="background-color:rgba(255,0,0,0.3)">left</span>  at least one member of  U.S.-led coalition forces <span style="background-color:rgba(255,0,0,0.3)">dead</span>. &rarr;</p>
                            <hr>
                            <p>ZABUL , Afghanistan — A complex attack on a military base in southern Afghanistan Monday  <span style="background-color:rgba(0,255,0,0.3)">killed </span> at least one member of <span style="background-color:rgba(0,255,0,0.3)">the </span> U.S.-led coalition forces.</p>
                        </div>

                        <h4>Sentences that match in meaning/purpose:</h4>
                        <h5>Example 1</h5>
                        <p><i>This is a sentence pair where an <u>event update</u> has occurred. The man went from being "suspected" of a crime to being confirmed as committing it.</i></p>

                        <div class="example">
                            <p>TAIPEI , Taiwan —  <span style="background-color:rgba(255,0,0,0.3)">Police</span> <span style="background-color:rgba(255,0,0,0.3)">officials</span> <span style="background-color:rgba(255,0,0,0.3)">in</span> <span style="background-color:rgba(255,0,0,0.3)">China</span> <span style="background-color:rgba(255,0,0,0.3)">said</span> <span style="background-color:rgba(255,0,0,0.3)">Thursday</span> <span style="background-color:rgba(255,0,0,0.3)">that</span> <span style="background-color:rgba(255,0,0,0.3)">they</span> <span style="background-color:rgba(255,0,0,0.3)">arrested</span> <span style="background-color:rgba(255,0,0,0.3)">a</span> man   <span style="background-color:rgba(255,0,0,0.3)">suspected</span> <span style="background-color:rgba(255,0,0,0.3)">of</span> <span style="background-color:rgba(255,0,0,0.3)">stabbing</span> <span style="background-color:rgba(255,0,0,0.3)">to</span> <span style="background-color:rgba(255,0,0,0.3)">death</span> six nurses and a manager   at a Chinese military <span style="background-color:rgba(255,0,0,0.3)">sanitarium</span>  in a seaside area famous for gatherings of Communist Party leaders.&rarr;</p>
                            <hr>
                            <p>TAIPEI , Taiwan — <span style="background-color:rgba(0,255,0,0.3)">A </span>           man <span style="background-color:rgba(0,255,0,0.3)">fatally </span> <span style="background-color:rgba(0,255,0,0.3)">stabbed </span>      six nurses and a manager <span style="background-color:rgba(0,255,0,0.3)">on </span> <span style="background-color:rgba(0,255,0,0.3)">Thursday </span> at a Chinese military  <span style="background-color:rgba(0,255,0,0.3)">hospital </span> in a seaside area famous for gatherings of Communist Party leaders <span style="background-color:rgba(0,255,0,0.3)">, </span> <span style="background-color:rgba(0,255,0,0.3)">police </span> <span style="background-color:rgba(0,255,0,0.3)">officials </span> <span style="background-color:rgba(0,255,0,0.3)">in </span> <span style="background-color:rgba(0,255,0,0.3)">China </span> <span style="background-color:rgba(0,255,0,0.3)">said </span> .</p>
                        </div>

                        <h5>Example 2</h5>
                        <p><i>This is a sentence group where one long sentence has been split into multiple sentences. While there is extra information added (e.g. one sentence adds "about 180 miles east of Beijing"), it is mainly
                        descriptive and the purpose of the sentences (i.e. to describe the crime further and give background for the reader) are the same.
                        </i></p>
                        <div class="example">
                            <p>The <span style="background-color:rgba(255,0,0,0.3)">police</span>                           said <span style="background-color:rgba(255,0,0,0.3)">the</span> <span style="background-color:rgba(255,0,0,0.3)">suspect</span> in <span style="background-color:rgba(255,0,0,0.3)">the</span> <span style="background-color:rgba(255,0,0,0.3)">killings</span>         Thursday morning in Beidaihe , a resort area in the Hebei Province city of Qinhuangdao ,                  is  <span style="background-color:rgba(255,0,0,0.3)">a</span> <span style="background-color:rgba(255,0,0,0.3)">sanitarium</span> employee <span style="background-color:rgba(255,0,0,0.3)">,</span> <span style="background-color:rgba(255,0,0,0.3)">indicating</span>   the attack was <span style="background-color:rgba(255,0,0,0.3)">likely</span>  not the result of a dispute over a patient ’s <span style="background-color:rgba(255,0,0,0.3)">treatment--</span>   <span style="background-color:rgba(255,0,0,0.3)">the</span> <span style="background-color:rgba(255,0,0,0.3)">suspect</span> <span style="background-color:rgba(255,0,0,0.3)">,</span> <span style="background-color:rgba(255,0,0,0.3)">a</span> <span style="background-color:rgba(255,0,0,0.3)">27-year</span> <span style="background-color:rgba(255,0,0,0.3)">-</span> <span style="background-color:rgba(255,0,0,0.3)">old</span> <span style="background-color:rgba(255,0,0,0.3)">man</span> <span style="background-color:rgba(255,0,0,0.3)">,</span> <span style="background-color:rgba(255,0,0,0.3)">had</span> <span style="background-color:rgba(255,0,0,0.3)">no</span> <span style="background-color:rgba(255,0,0,0.3)">known</span> <span style="background-color:rgba(255,0,0,0.3)">conflict</span> <span style="background-color:rgba(255,0,0,0.3)">with</span> <span style="background-color:rgba(255,0,0,0.3)">the</span> victims <span style="background-color:rgba(255,0,0,0.3)">,</span> <span style="background-color:rgba(255,0,0,0.3)">who</span> were killed in a women ’s dormitory at the hospital               , the  <span style="background-color:rgba(255,0,0,0.3)">Qinhuangdao</span> <span style="background-color:rgba(255,0,0,0.3)">City</span> <span style="background-color:rgba(255,0,0,0.3)">Public</span> <span style="background-color:rgba(255,0,0,0.3)">Security</span> <span style="background-color:rgba(255,0,0,0.3)">Bureau</span> said <span style="background-color:rgba(255,0,0,0.3)">in</span> <span style="background-color:rgba(255,0,0,0.3)">a</span> <span style="background-color:rgba(255,0,0,0.3)">statement</span> <span style="background-color:rgba(255,0,0,0.3)">online</span> . &rarr;</p>
                            <hr>
                            <p>The                                              suspect , a 27-year - old   <span style="background-color:rgba(0,255,0,0.3)">hospital </span> <span style="background-color:rgba(0,255,0,0.3)">employee </span> <span style="background-color:rgba(0,255,0,0.3)">who </span> had no known   <span style="background-color:rgba(0,255,0,0.3)">motive </span> <span style="background-color:rgba(0,255,0,0.3)">, </span> <span style="background-color:rgba(0,255,0,0.3)">was </span> <span style="background-color:rgba(0,255,0,0.3)">arrested </span> <span style="background-color:rgba(0,255,0,0.3)">after </span> the <span style="background-color:rgba(0,255,0,0.3)">attacks </span>              , the Qinhuangdao City Public Security Bureau said in a statement online .</p>
                            <p>The <span style="background-color:rgba(0,255,0,0.3)">stabbings </span> <span style="background-color:rgba(0,255,0,0.3)">took </span> <span style="background-color:rgba(0,255,0,0.3)">place </span>        Thursday morning in Beidaihe , a resort area in the Hebei Province city of Qinhuangdao , <span style="background-color:rgba(0,255,0,0.3)">about </span> <span style="background-color:rgba(0,255,0,0.3)">180 </span> <span style="background-color:rgba(0,255,0,0.3)">miles </span> <span style="background-color:rgba(0,255,0,0.3)">east </span>              of <span style="background-color:rgba(0,255,0,0.3)">Beijing </span>                                                .</p>
                            <p>   <span style="background-color:rgba(0,255,0,0.3)">But </span> <span style="background-color:rgba(0,255,0,0.3)">the </span> <span style="background-color:rgba(0,255,0,0.3)">fact </span> <span style="background-color:rgba(0,255,0,0.3)">that </span> the suspect in the     Beidaihe <span style="background-color:rgba(0,255,0,0.3)">case </span>             is <span style="background-color:rgba(0,255,0,0.3)">an </span>   employee   <span style="background-color:rgba(0,255,0,0.3)">indicates </span> <span style="background-color:rgba(0,255,0,0.3)">that </span> the attack was  <span style="background-color:rgba(0,255,0,0.3)">probably </span> not the result of a dispute over a patient ’s <span style="background-color:rgba(0,255,0,0.3)">treatment </span>                                         .</p>
                            <p>The                                                            victims   were killed in a women ’s dormitory at the hospital <span style="background-color:rgba(0,255,0,0.3)">for </span> <span style="background-color:rgba(0,255,0,0.3)">elderly </span> <span style="background-color:rgba(0,255,0,0.3)">military </span> <span style="background-color:rgba(0,255,0,0.3)">personnel </span> <span style="background-color:rgba(0,255,0,0.3)">, </span> <span style="background-color:rgba(0,255,0,0.3)">also </span> <span style="background-color:rgba(0,255,0,0.3)">known </span> <span style="background-color:rgba(0,255,0,0.3)">as </span> <span style="background-color:rgba(0,255,0,0.3)">People </span> <span style="background-color:rgba(0,255,0,0.3)">’s </span> <span style="background-color:rgba(0,255,0,0.3)">Liberation </span> <span style="background-color:rgba(0,255,0,0.3)">Army </span> <span style="background-color:rgba(0,255,0,0.3)">Hospital </span> <span style="background-color:rgba(0,255,0,0.3)">281 </span> , the <span style="background-color:rgba(0,255,0,0.3)">statement </span>      said     .</p>
                        </div>


                    </div>
                </div>
              </div>
            </div>
            </div>
        </div>
    <br>
    <hr class="hr-medium">
    <br>
    <h2><u>Task:</u></h2>
    <p><em>Right click and select "Remove" for all connections between sentences that do NOT match.
       <br>Read above for more detailed instructions and examples.</em></p>
    <br>
<!--    <h4>Headline: </h4>-->
    <p>Article Key: ('ap', 5390, 0, 1)</p>
    <br>
    <div class="row header" >
        <div class="col-4" doc_id="('ap', 5390, 0, 1)" ><h3>Article</h3></div>
        <div class="col-8" doc_id="('ap', 5390, 0, 1)" ></div>
    </div>
    <div class="row subheader" >
        <div class="col-4" doc_id="('ap', 5390, 0, 1)" ><h4>Original Article</h4>
            <div class="row"></div>
        </div>
        <div class="col-8" doc_id="('ap', 5390, 0, 1)" ><h4>Editing Sandbox</h4></div>
    </div>
    <!--    <div class="test row">-->
    <!--        &lt;!&ndash; reference       &ndash;&gt;-->
    <!--        <div class="col-4" doc_id="('ap', 5390, 0, 1)" >-->
    <!--            <div class="textblock-row row">-->
    <!--                <div class="textblock row ui-draggable ui-draggable-handle" id="sentence-ref-100">-->
    <!--                    <div class="col-12 textblock-text-div">-->
    <!--                        <span class="textblock_span">Hundreds of university students in Kabul have held protests over US airstrikes which reportedly killed more than 100 civilians last week.</span>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--        <div class="col-8" doc_id="('ap', 5390, 0, 1)" >-->
    <!--            <ul>-->
    <!--                <li class="textblock-row ui-sortable-handle">-->
    <!--                    <div class="row d-inline-flex textblock" id="sentence-100" label="NODE">-->
    <!--                        <div class="col-6 textblock-text-div">-->
    <!--                            <span class="textblock_span">Hundreds of university students in Kabul have held protests over US airstrikes which reportedly killed more than 100 civilians last week.</span>-->
    <!--                        </div>-->
    <!--                        <div class="col-2 add-above-button"><div class="btn btn-outline-success">Add Above</div></div>-->
    <!--                        <div class="col-2 add-below-button"><div class="btn btn-outline-success">Add Below</div></div>-->
    <!--                        <div class="col-2 delete-button"><div class="btn btn-outline-success">Delete</div></div></div>-->
    <!--                </li>-->
    <!--            </ul>-->
    <!--        </div>-->
    <!--    </div>-->

    <div class="row text" >
        <div class="col-3 textblock_pool_ref" doc_id="('ap', 5390, 0, 1)" ></div>
        <div class="col-1 filler" doc_id="('ap', 5390, 0, 1)" ></div>
        <div class="col-6 row" doc_id="('ap', 5390, 0, 1)" ><ul class="textblock_pool"></ul></div>
    </div>
    <div class="row annotation">
	    <div class="error question col-4" doc_id="('ap', 5390, 0, 1)" error_type='error'>
		  <p>
    	  <h4>Does this article have errors?</h4>
    	  <div id="error_btn_grp" class="btn-group-vertical btn-group-toggle" role="group" data-toggle="buttons">
              <div class="btn-group">
                <label class="btn btn-outline-success btn-sm active" label="legit">
                    <input type="radio" name="options" autocomplete="off" checked>No errors</label>
                <label class="btn btn-outline-danger btn-sm" label="incom_sentence">
                 <input type="radio" name="options" autocomplete="off" checked>Incomplete Sentences</label>
              </div>
              <div class="btn-group">
                <label class="btn btn-outline-danger btn-sm" label="other" id="otherbutton">
                    <input type="radio" name="options" autocomplete="off" checked>Other</label>
                <input id="otherform" type="text" class="form-control hidden"
                       aria-label="Text input with radio button" placeholder="Specify...">
              </div>
		  </div>
		  </p>
		</div>
	    <div class="error question col-4" doc_id="('ap', 5390, 0, 1)" error_type='confidence'>
		  <p>
    	  <h4>How confident are you in this tagging?</h4>
    	  <div class="btn-group-vertical btn-group-toggle" role="group" data-toggle="buttons">
              <div class="btn-group">
                <label class="btn btn-outline-success btn-sm" label="redo">
                    <input type="radio" name="options" autocomplete="off" checked>1 - Needs Redo</label>
                <label class="btn btn-outline-success btn-sm" label="check">
                    <input type="radio" name="options" autocomplete="off" checked>2 - Needs Check</label>
                <label class="btn btn-outline-success btn-sm" label="glance">
                    <input type="radio" name="options" autocomplete="off" checked>3 - Needs Glance</label>
              </div>
              <div class="btn-group">
                <label class="btn btn-outline-success btn-sm active" label="ok">
                    <input type="radio" name="options" autocomplete="off" checked>4 - Should be OK</label>
                <label class="btn btn-outline-success btn-sm" label="perfect">
                    <input type="radio" name="options" autocomplete="off" checked>5 - Confident</label>
              </div>
		  </div>
		 </p>
		</div>
		 </p>
      </div>
    </div>

<input type='hidden' value='' name='data' id='data'/>
<div class="container">
    <div class="row">
        <input class="btn btn-outline-success" type='submit' id='submitButton' value='Submit'>
    </div>
<hr>
    <div class="row">
        <div class="col-12">
        <h3>Optional Feedback:</h3>
            <p>
            We'd love to hear some feedback on this task: if any parts were confusing, or the task itself could
            be formulated better, we'd love to hear any comments, ideas or suggestions. Please send an email through Mechanical Turk! We read all of our emails. We really appreciate your help!
            </p>
        </div>
        <hr>
    </div>
    <hr>
    <br>
    <div class="row">
        <input class="btn btn-outline-danger" type='submit' id='revert' value='Revert'>
    </div>
</div>
</form>

<script language='Javascript'>

    $('#otherbutton').on('click', function(d){
        $('#otherform').removeClass('hidden')
    })

    $('#otherform').on('click', function(d){
        $('#error_btn_grp').find('label').removeClass('active')
        $('#otherbutton').addClass('active')
    })

    $('#otherbutton2').on('click', function(d){
        $('#otherform2').removeClass('hidden')
    })

    $('#otherform2').on('click', function(d){
        $('#law_type_btn_grp').find('label').removeClass('active')
        $('#otherbutton2').addClass('active')
    })

    var window_height = $( window ).height();
    String.prototype.replaceAll = function(search, replacement) {
        var target = this;
        return target.replace(new RegExp(search, 'g'), replacement);
    };
    String.prototype.toTitleCase = function() {
        var target = this;
        return target.replace(/(?:^|\s)\w/g, function(match) {
            return match.toUpperCase();
        });
    };
    Array.prototype.remove_duplicates = function() {
        var arr = this;
        let s = new Set(arr);
        let it = s.values();
        return Array.from(it);
    };

    (function(old) {
      $.fn.attr = function() {
        if(arguments.length === 0) {
          if(this.length === 0) {
            return null;
          }

          var obj = {};
          $.each(this[0].attributes, function() {
            if(this.specified) {
              obj[this.name] = this.value;
            }
          });
          return obj;
        }

        return old.apply(this, arguments);
      };
    })($.fn.attr);

    // page handling
    class PageManager {
	constructor(
	    textblock_dim,
        demo,
        check,
        doc_key,
        dropdown_buttons,
        textblock_pool_min
	) {
		this.demo = demo
		this.check = check
		this.doc_key = doc_key
		// dropdown buttons
		this.dropdown_buttons = dropdown_buttons
		// dimensions for textblock divs
		this.textblock_pool_min = textblock_pool_min
		this.textblock_dim = textblock_dim;
		this.start_line_id = null
		// z-index for dropdown needs to increase every click :/ maybe not the best implementation
		this.curr_dropdown_zindex = 3
	}

	_get_new_connection_idx(){
	    return $('.connection').length
    }

    // create a connection from input data (to re-create datapoints)
    create_static_connection(left_textblock, right_textblock, diff_ratio, class_name){
    	var line_selector = 'line-' + this._get_new_connection_idx()
        var textblock_x_selector = 'sentence-ref-' + left_textblock
        var textblock_y_selector = 'sentence-' + right_textblock

        //
        $('#' + textblock_x_selector).connections({
			to: '#' + textblock_y_selector,
			class: 'connection ' + line_selector
		})

		// make dropdown
        return line_selector
    }

	create_reference_textblock(selected_text, block_type, block_id){
        var that = this
        // create textblock element for the righthand side
        var textblock_pool = $('.textblock_pool_ref').filter(
            function (d) {
                return $(d).attr('doc_id') == this.doc_key
            }
        )
        // create textblock div
        var textblock_row = document.createElement('div')
        $(textblock_row).addClass('textblock-row-ref row')
        //
        var textblock_div = document.createElement('div')
        $(textblock_div)
        	.addClass('textblock-ref row')
        	.attr('doc_id', that.doc_key)
	       	.attr('id', 'sentence-ref-' + block_id)

        var textblock_text_div = document.createElement('div')
        $(textblock_text_div).addClass('textblock-text-div col-12')

        var textblock_span = document.createElement('span')
        $(textblock_span).addClass('textblock_span')
        textblock_span.textContent = selected_text
        // append elements to the textblock
        $(textblock_text_div).append(textblock_span)
        $(textblock_div).append(textblock_text_div)

        // append textblock to the pool of textblocks
        $(textblock_row).append(textblock_div)
    	$(textblock_row).appendTo(textblock_pool)
		$(textblock_div) // .draggable();

		// dynamically resize the height of the textblock pool
        this.resize_textblock_pool(textblock_pool)
    }

    resize_textblock_pool(textblock_pool_class_sel){
	    if (! textblock_pool_class_sel)
	        textblock_pool_class_sel = '.textblock_pool'

	    var that = this
        var multiplier = 2
	    var new_height = d3.sum(
	        $(textblock_pool_class_sel).find('.textblock').map(function(i, d){
     			return $(d).height() + multiplier * (
 	    		    that.textblock_dim.margin + that.textblock_dim.border + that.textblock_dim.padding
                ) // 2 * (margin + border + padding)
 		}))
       $(textblock_pool_class_sel).css('height', d3.max([this.textblock_pool_min, new_height]))

    }

    create_one_textblock(selected_text, block_type, is_new, block_id, textblock_pool_class_sel){
        var that = this
	    // slot
        var textblock_row = document.createElement('li')
        $(textblock_row)
            .addClass('textblock-row')
            .addClass('row')
            // .addClass('d-inline-flex')


        // draggable div
        var textblock_div = document.createElement('div')
        $(textblock_div)
        	.addClass('col-12')
            .addClass('d-inline-flex')
            .addClass('textblock')
        	.attr('doc_id', that.doc_key)
	       	.attr('id', 'sentence-' + block_id)
            .attr('orig-position', block_id)
	       	.attr('label', block_type)
            .attr('is_new', is_new)

        var textblock_text_div = document.createElement('div')
        $(textblock_text_div).addClass('col-6 textblock-text-div')

        // text content
        var textblock_span = document.createElement('span')
        $(textblock_span).addClass('textblock_span')
        textblock_span.textContent = selected_text
        $(textblock_text_div).append(textblock_span)
        // $(textblock_row).append(textblock_text_div)
        $(textblock_div).append(textblock_text_div)
        // $(textblock_div_div).append(textblock_text_div)

        // add button
        var add_above_button_div = document.createElement('div')
        $(add_above_button_div).addClass('col-2 add-above-button center-button')
        var add_above_button = document.createElement('div')
        add_above_button.textContent = 'Add Above'
        $(add_above_button).addClass('btn btn-outline-success')
        $(add_above_button).on('click', function(d){
            var new_textblock = that.create_one_textblock('[NEW SENTENCE]', 'NODE', true, textblock_pool_class_sel)
            // update so we insert it below
            $(this).parents('li').before(new_textblock)
            $(textblock_pool_class_sel).sortable('refresh');
            that.resize_textblock_pool(textblock_pool_class_sel)
        })

        $(add_above_button_div).append(add_above_button)
        // $(textblock_row).append(add_above_button_div)
        $(textblock_div).append(add_above_button_div)
        // $(textblock_div_div).append(add_above_button_div)

        var add_below_button_div = document.createElement('div')
        $(add_below_button_div).addClass('col-2 add-below-button center-button')
        var add_below_button = document.createElement('div')
        $(add_below_button).addClass('btn btn-outline-success align-middle')
        add_below_button.textContent = 'Add Below'
        $(add_below_button).on('click', function(d){
            var new_textblock = that.create_one_textblock('[NEW SENTENCE]', 'NODE', true, textblock_pool_class_sel)
            // update so we insert it below
            $(this).parents('li').after(new_textblock)
            $(textblock_pool_class_sel).sortable('refresh');
            that.resize_textblock_pool(textblock_pool_class_sel)
        })
        $(add_below_button_div).append(add_below_button)
        // $(textblock_row).append(add_below_button_div)
        $(textblock_div).append(add_below_button_div)
        // $(textblock_div_div).append(add_below_button_div)


        var delete_button_div = document.createElement('div')
        $(delete_button_div).addClass('col-2 delete-button center-button')
        var delete_button = document.createElement('div')
        $(delete_button).addClass('btn btn-outline-success')
        delete_button.textContent = 'Delete'
        $(textblock_div).attr('state', 'undeleted')
        $(delete_button).on('click', function(d){
            var textblock = $(this).parents('.textblock')
            var is_new = textblock.attr('is_new')
            if (is_new == 'true') {
                $(this).parents('.textblock-row').remove();
                $(textblock_pool_class_sel).sortable('refresh');
                that.resize_textblock_pool(textblock_pool_class_sel)
            }
            else {
                var state = textblock.attr('state')
                if (state == 'undeleted') {
                    textblock.addClass('textblock-deleted')
                    textblock.find('.textblock-text-div').addClass('textblock-text-deleted')
                    textblock.attr('state', 'deleted')
                    $(this).text('Restore')
                    textblock.find('.add-above-button').addClass('hidden')
                    textblock.find('.add-below-button').addClass('hidden')
                }
                else {
                    textblock.removeClass('textblock-deleted')
                    textblock.find('.textblock-text-div').removeClass('textblock-text-deleted')
                    textblock.attr('state', 'undeleted')
                    $(this).text('Delete')
                    textblock.find('.add-above-button').removeClass('hidden')
                    textblock.find('.add-below-button').removeClass('hidden')
                }
            }
        })
        $(delete_button_div).append(delete_button)
        $(textblock_div).append(delete_button_div)
        // $(textblock_div_div).append(delete_button_div)
        // $(textblock_row).append(delete_button_div)


        // append elements to the textblock
        // $(textblock_div).append(textblock_div_div)
    	$(textblock_row).append(textblock_div)
        return textblock_row
    }

    create_sortable_textblock(selected_text, block_type, block_id){
    	var that = this
        // create textblock element for the righthand side
        var textblock_pool = $('.textblock_pool').filter(
            function (d) {
                return $(d).attr('doc_id') == this.doc_key
            }
        )
        var textblock_row = this.create_one_textblock(selected_text, block_type, false, block_id, '.textblock_pool')

    	$(textblock_pool).append(textblock_row)
        this.resize_textblock_pool('.textblock_pool')
    }
}

    textblock_dims = {
		'margin': 5,
		'border': 2,
		'padding': 10
	}

	textblock_pool_min_height = 200

    buttons = [
		['NODE', 'btn-outline-primary', 'node'],
    ]
    pm = new PageManager(
		textblock_dims, false, false,
		"('ap', 5390, 0, 1)", buttons,
		textblock_pool_min_height
	)

    function render_page() {
        data = JSON.parse('{"arcs": [{"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": NaN, "sent_idx_y": 9.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": NaN, "sent_idx_y": 8.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": NaN, "sent_idx_y": 3.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": 1.0, "sent_idx_y": NaN, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": 7.0, "sent_idx_y": NaN, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": 6.0, "sent_idx_y": NaN, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": 4.0, "sent_idx_y": NaN, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": 5.0, "sent_idx_y": NaN, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": 0.4158221060702492, "avg_sentence_distance_y": 0.4158221060702492, "sent_idx_x": 0.0, "sent_idx_y": 0.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": NaN, "sent_idx_y": 6.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": NaN, "sent_idx_y": 5.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": NaN, "sent_idx_y": 2.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": NaN, "sent_idx_y": 7.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": 8.0, "sent_idx_y": NaN, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": NaN, "sent_idx_y": 1.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": NaN, "avg_sentence_distance_y": NaN, "sent_idx_x": 3.0, "sent_idx_y": NaN, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": 0.3970499451234552, "avg_sentence_distance_y": 0.3989061468472285, "sent_idx_x": 2.0, "sent_idx_y": 4.0, "version_x": 0, "version_y": 1}, {"avg_sentence_distance_x": 0.0, "avg_sentence_distance_y": 0.0, "sent_idx_x": 9.0, "sent_idx_y": 10.0, "version_x": 0, "version_y": 1}], "nodes": [{"sent_idx": 0, "sentence": "UNITED NATIONS (AP) -- U.S.", "version": 0}, {"sent_idx": 1, "sentence": "Ambassador Nikki Haley said Tuesday that U.N. peacekeeping has made \u0027\u0027a great contribution\u0027\u0027 to Haiti and the Security Council\u0027s expected vote to withdraw all troops from the Caribbean nation by mid-October is an example of how peacekeeping missions should change as a country\u0027s political situation changes.", "version": 0}, {"sent_idx": 2, "sentence": "The United States is currently reviewing the U.N.\u0027s 16 far-flung peacekeeping operations to assess costs and effectiveness and Haley told the Security Council that thanks to recent elections in Haiti \u0027\u0027the political context is right\u0027\u0027 for a new and smaller mission.", "version": 0}, {"sent_idx": 3, "sentence": "She strongly backed the transformation of Haiti\u0027s U.N. mission from military patrols to focusing on developing the country\u0027s police force, supporting the rule of law and protecting human rights.", "version": 0}, {"sent_idx": 4, "sentence": "The Security Council is scheduled to vote Thursday on a resolution to withdraw the 2,370 military personnel by Oct. 15. Sandra Honore, the U.N. envoy for Haiti, told the council that as a result of successful presidential and legislative elections on Nov. 20 and Jan. 29 \u0027\u0027Haiti\u0027s political outlook for 2017 and beyond has significantly improved.", "version": 0}, {"sent_idx": 5, "sentence": "\u0027\u0027 She said this has opened \u0027\u0027a crucial window of opportunity to address the root causes of the political crisis\u0027\u0027 that preceded the elections and address \u0027\u0027the many pressing challenges facing the country.\u0027\u0027 \u0027\u0027A relatively stable security situation prevails, despite continuous signs of fragility,\u0027\u0027 Honore said.", "version": 0}, {"sent_idx": 6, "sentence": "She said international support, including from the United Nations, will be needed to enable the national police \u0027\u0027to eventually provide security for all Haitian citizens.\u0027\u0027 Honore said she has called on the government to make further professionalization of the police and the preservation of its \u0027\u0027apolitical character\u0027\u0027 a priority.", "version": 0}, {"sent_idx": 7, "sentence": "The new government must also improve the administration of justice and human rights \u0027\u0027to truly anchor the rule of law,\u0027\u0027 she said.", "version": 0}, {"sent_idx": 8, "sentence": "This is essential, Honore said, to make policing more effective and create conditions for foreign and domestic investment and job creation.", "version": 0}, {"sent_idx": 9, "sentence": "", "version": 0}]}'.replaceAll('NaN', 'null'))
        $(data.nodes).each(function (i, d) {
            pm.create_reference_textblock(d.sentence, 'NODE', d.sent_idx)
            pm.create_sortable_textblock(d.sentence, 'NODE', d.sent_idx)
            pm.create_static_connection(d.sent_idx, d.sent_idx)
        })
        $('.textblock_pool').sortable({
            "update": function (event, ui) {
                $(ui.item).find('.textblock').attr('touched', true)
            }
        })
    }
    render_page()

    function delete_and_start_over(){
        $('.textblock-row').remove()
        $('.textblock-row-ref').remove()
        $('.connection').remove()
        render_page()
    }

    $('#revert').on('click', function(e){
        e.preventDefault();
        var confirmed = confirm('Are you sure you want to revert?')
        if (confirmed){
            delete_and_start_over()
        }
    })


    $('.textblock')
        .on('mouseover', function(){})
        .on('mouseout',  function(){})

     $.repeat().add('connection').each($).connections('update').wait(0);


    //
    // mturk
    //
    // handle data
    //
    var bool_to_int = {
        true: 1,
        false: 0
    }
    function _sum(arr) {
        var r = 0;
        $.each(arr, function(i, v) {
            r += +v;
        });
        return r;
    }

    class SubmitHandler{
        constructor() {
            turkSetAssignmentID();
            this.GENERIC_THANKS_MESSAGE = 'Thank you so much for your help with our task!'
            this.completed_checks = false
        }

        _num_added(i){
            return _sum(this.running_added_list.slice(0, i))
        }
        _num_deleted(i){
            return _sum(this.running_deleted_list.slice(0, i))
        }

        _build_lists(d){
            var is_deleted = $(d).attr('state') == 'deleted'
            var is_added = !$(d).attr('orig-position')
            this.running_added_list.push(bool_to_int[is_added])
            this.running_deleted_list.push(bool_to_int[is_deleted])
        }

        _format_data(i, d, question_class){
            var is_deleted = $(d).attr('state') == 'deleted'
            var is_added = !$(d).attr('orig-position')
            this.output['num-nodes-removed'] = this.output['num-nodes-removed'] + bool_to_int[is_deleted]
            this.output['num-nodes-added'] = this.output['num-nodes-added'] + bool_to_int[is_added]

            var orig_position = parseInt($(d).attr('orig-position')) - this._num_deleted(i);
            var new_position = i - this._num_deleted(i) - this._num_added(i);
            var is_refactored = (new_position != orig_position) && ($(d).attr('touched') == 'true');
            this.output['num-nodes-refactored'] = this.output['num-nodes-refactored'] + bool_to_int[is_refactored]

            if (is_deleted)
                var new_idx = 'undefined'
            else
                var new_idx = i - this._num_deleted(i)

            return {
                "doc_id": "('ap', 5390, 0, 1)",
                "question_class": question_class,
                "orig_sent_idx": $(d).attr('id').split('-')[1],
                "new_sent_idx": new_idx,
                "text": $(d).find('.textblock-text-div').text(),
                "is_added": is_added,
                'is_refactored': is_refactored,
                'is_deleted': is_deleted
            }
        }

        get_data_from_dom() {
            var that = this
            that.num_nodes = data.nodes.length
            that.running_deleted_list = []
            that.running_added_list = []
            that.output = {
                'doc_id': "('ap', 5390, 0, 1)",
                'final-list': [],
                'nodes': data.nodes,
                'num-nodes-removed': 0,
                'num-nodes-added': 0,
                'num-nodes-refactored': 0,
            }

            // build lists
            $('.textblock_pool')
                .find('.textblock')
                .each(function (i, d) {
                    that._build_lists(d);
            })


            $('.textblock_pool')
                .find('.textblock')
                .each(function (i, d) {
                    var datum = that._format_data(i, d, 'final ordering');
                    that.output['final-list'].push(datum)
            })
        }

        gather_and_submit_data(submit_button, submit_click_event) {
            this.submit_button = submit_button
            this.submit_click_event = submit_click_event
            this.get_data_from_dom()
            this.first_check() // -> second_confirm -> third_confirm -> submit_data
        }

        first_check(){
            var that = this
            alertify.confirm(
                    "You\'ve added " + this.output['num-nodes-added'] + " nodes, deleted " + this.output['num-nodes-removed'] + " and refactored (roughly) " + this.output['num-nodes-refactored'] + ". Does that look correct?",
            ).set('header', '<em>Checking number of nodes drawn...</em>')
             .set('labels', {
                        ok: "Continue, submit!",
                        cancel: "Let me recheck..."
                    })
                 .set('onok', function () {
                        that.third_check()
                    })
                 .set('oncancel', function() {
                        alertify.error('Thanks for being diligent! Please recheck and resubmit!')
                    })
        }

        third_check(){
            var that = this
            setTimeout(function() {
                alertify.confirm(
                    "Great! Your submission is valid. Please take a moment to check out the real edits that were performed to the article you just looked at, here:" +
                    "<br><br>" +
                    "<a target='_blank' rel='noopener noreferrer' href='https://news-edits-dot-usc-research.appspot.com/check_task?source=ap&doc_id=5390&v_x=0&v_y=1'>https://news-edits-dot-usc-research.appspot.com/check_task?source=ap&doc_id=5390&v_x=0&v_y=1</a>" +
                    "<br><br>" +
                    "But please do not update your answers here after you've looked at the real edits. The purpose of this is to help guide you for future tasks." +
                    "<br><br>" +
                    "When you're done, please hit submit to record the task!"
                ).set('header', '<em>Looks good! Ready to Submit?</em>')
                    .set('labels', {
                        ok: "Continue, submit!",
                        cancel: "Let me recheck..."
                    })
                    .set('onok', function () {
                        alertify.success('Ok! Submitting...')
                        alertify.success(that.GENERIC_THANKS_MESSAGE)
                        that.record_data()
                    })
                    .set('oncancel', function () {
                        alertify.error('Thanks for being diligent! Please recheck and resubmit!')
                    })
            }, 700)
        }
        record_data(){
            
            // submit mturk
            $('#data').attr('value', JSON.stringify(this.output))
            this.completed_checks = true
            $(this.submit_button).trigger(this.submit_click_event.type);
            
        }
    }

    // submit button click
    var sh = new SubmitHandler()
    $('#submitButton').on('click', function(submit_click_event){
        var submit_button = this
        if (! sh.completed_checks) {
            submit_click_event.preventDefault();
            sh.gather_and_submit_data(submit_button, submit_click_event);
        }
    })

</script>
</body></html>
<!-- YOUR HTML ENDS -->

]]>
</HTMLContent>
<FrameHeight>600</FrameHeight>
</HTMLQuestion>